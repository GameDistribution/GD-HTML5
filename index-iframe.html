<html>
<head>
    <title>Gamedistribution.com HTML5 SDK</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <style>
        body, html {
            overflow: hidden;
			margin:0;
			padding:0;
        }

        iframe#container {
            position:absolute;
            top:0;
            left:0;
            width:100vw;
            height:100vh;
            border:none;
        }
    </style>
</head>
<body>

<iframe id="container"></iframe>

<script type="application/javascript">
    function getParentDomain() {
        const referrer = (window.location !== window.parent.location)
            ? (document.referrer && document.referrer !== '')
                ? document.referrer.split('/')[2]
                : document.location.host
            : document.location.host;
        let domain = referrer.replace(/^(?:https?:\/\/)?(?:www\.)?/i, '').
            split('/')[0];
        // If the referrer is gameplayer.io. (Spil Games)
        if (document.referrer.indexOf('gameplayer.io') !== -1) {
            domain = 'gamedistribution.com';
            // Now check if they provide us with a referrer URL.
            if (document.referrer.indexOf('?ref=') !== -1) {
                let returnedResult = document.referrer.substr(document.referrer.indexOf(
                    '?ref=') + 5);
                // Guess sometimes they can give us empty or wrong values.
                if (returnedResult !== '' &&
                    returnedResult !== '{portal%20name}' &&
                    returnedResult !== '{portal name}') {
                    returnedResult = fullyDecodeURI(returnedResult);
                    domain = returnedResult.replace(
                        /^(?:https?:\/\/)?(?:www\.)?/i, '').split('/')[0];
                    console.info('Spil referrer domain: ' + domain);
                }
            }
        }
        return domain;
    }

    var gameUrl = "http://localhost:3000/demo-game.html";
    document.getElementById('container').src = gameUrl + "?GD_SDK_REFERRER_URL="+getParentDomain();

</script>

</body>
</html>